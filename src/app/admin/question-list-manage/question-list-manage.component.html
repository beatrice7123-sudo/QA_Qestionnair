<div style="position: fixed;pointer-events: none;inset: 0;
            min-height: 100%;width: 100%;background-color: #4c4c4ce1;
            font-size: 20px; z-index: -1;"></div>
<div style="width:100vw;height:100vh;top:0;left: 0;
            display: grid;place-items: center;font-size: 20px;">
  <div style="display: flex; flex-direction: column;
              justify-content: flex-start; align-items: center; width:1000px;
              height: 690px; border: none; ">
    <div style="background-color: #ffeec1;
                width: 1000px; height: 250px; border-radius: 15px;
                display: flex; flex-direction: column;
                justify-content: center; align-items: center;">
      <div style="display: flex;flex-direction: column;align-items: baseline;margin-top: 40px;">
        <label>
          ÂïèÂç∑ÂêçÁ®±Ôºö <input (keyup)="letterSearch()" [(ngModel)]="searchData"
                      style="width:555px;height:25px;background-color: #fff8e4;
                              border:none;border-radius: 5px;"></label>
        <label style="margin:13px;">
          ÂïèÂç∑ÊôÇÈñìÔºö<input type="date" style="width:200px;height:25px;border-radius: 5px;
                                              margin:0px 10px;text-align: center;font-size: 18px;
                                              background-color: #fff8e4;border:none; color: #ffca61;"
                            [(ngModel)]="searchBegin">
          ~ <input type="date" style="width:200px;height:25px;border-radius: 5px;
                                      margin:0px 10px;text-align: center;font-size: 18px;
                                      background-color: #fff8e4;border:none; color: #ffca61;"
                    [(ngModel)]="searchEnd">
          <button (click)="QuestionnaireDateSearch()" class="searchBtn"
                  style="background-color: #fff8e4; border:1px solid;
                          width:80px;border-radius: 7px;font-size: 15px;margin-top: 13px;
                          font-family: 'LXGW WenKai TC', monospace;">ÈñãÂßãÊêúÂ∞ã</button>
        </label>
      </div>
      <div>
        @for(btn of buttons;track $index;let i = $index){
          <button class="searchBtn" (click)="selectButton(i)"
                  [class.active]="selectedBtnIndex === i">
            {{ btn.label }}
          </button>
        }
      </div>
    </div>

    <div style="border: none;border-radius: 15px;
                width: 1000px;height: fit-content;">
      <label style="display: flex;flex-direction: row;color: #fff8e4;">
        <div style="font-size: 50px;margin:0px 10px;" (click)="goToTrashcan()">üóë</div>
        <div style="font-size: 50px;margin:0px 10px;" (click)="openDialog()">+</div>
      </label>

      <dialog #addQuizDialog>
        <div (click)="closeDialog()" style="justify-self:flex-end;margin-right:20px;cursor: pointer;">‚úï</div>
        <div class="tabs">
          <button class="tab-btn" [class.active]="activeTab==='tab1'" (click)="activeTab='tab1'">ÂïèÂç∑</button>
          <button class="tab-btn" [class.active]="activeTab==='tab2'" (click)="activeTab='tab2'">È°åÁõÆ</button>
        </div>

        @if (activeTab === 'tab1') {
          <div style="flex: 1;overflow-y: auto;display: flex;flex-direction: column;justify-content: center;align-items: center;">
            <label style="margin:20px 0px;">ÂïèÂç∑ÂêçÁ®±Ôºö
              <input style="width:500px;border-radius: 5px;font-family: 'LXGW WenKai TC', monospace;" [(ngModel)]="title"></label>
            <label style="margin:20px 0px;" style="display: flex; align-items: flex-start;">ÂïèÂç∑Ë™™ÊòéÔºö
              <textarea style="width:500px;border-radius: 5px;font-family: 'LXGW WenKai TC', monospace;" [(ngModel)]="description"></textarea></label>
            <label style="margin:13px;">
              ÂïèÂç∑ÊôÇÈñìÔºö<input type="date"
                    style="width:225px;height:25px;border-radius:5px;margin:0 10px;
                            text-align:center;font-size:18px;background-color:#ffffff;
                            border:none;color:#ffca61;font-family: 'LXGW WenKai TC', monospace;"
                    [(ngModel)]="startDate">
                ~<input type="date"
                    style="width:225px;height:25px;border-radius:5px;margin:0 10px;
                            text-align:center;font-size:18px;background-color:#ffffff;
                            border:none;color:#ffca61;font-family: 'LXGW WenKai TC', monospace;"
                    [(ngModel)]="endDate">
            </label>
            <div style="width:500px;display: flex;justify-content: space-between;
                        margin-top:100px;">
              <button class="dialogBtn"  (click)="cancel()">ÂèñÊ∂à</button>
              <button class="dialogBtn" (click)="saveQuestion()">Á¢∫ÂÆö</button>
            </div>
          </div>

        } @else if (activeTab === 'tab2') {
          <div style="margin-top: 10px;">
            <!-- ---------------------------------------------------------------------------- -->
            @if(questionVoList.length==0){
              <div #editArea class="edit-section">
                <h3 style="width:500px;margin:10px;">Êñ∞Â¢ûÈ°åÁõÆ</h3>
                <div style="width:500px;display: flex;flex-direction: column;justify-content: center;align-items: first baseline;">
                  <div>
                    È°åÁõÆÂÖßÂÆπÔºö
                    <input type="text" [(ngModel)]="question"
                            style="width:350px;border-radius: 5px;height:30px;font-size: 15px; font-family: 'LXGW WenKai TC', monospace;">
                  </div>
                  <label style="margin: 10px;">
                    <span style="margin-right:24px;margin-left: 24px;">È°ûÂûãÔºö</span>
                    <select [(ngModel)]="type"
                            style="width:200px;height:30px;border:none;border-radius: 10px;
                                    text-align: center;font-size: 15px;font-family: 'LXGW WenKai TC', monospace;">
                      <option value="single">ÂñÆÈÅ∏</option>
                      <option value="multiple">Â§öÈÅ∏</option>
                      <option value="text">Á∞°Á≠î</option>
                    </select>
                  </label>
                  <div style="display: flex;flex-direction: row;">
                    <p style="margin-right:24px;margin-left: 24px;margin-top:0px;">ÈÅ∏È†ÖÔºö</p>
                    <div style="display: flex;flex-direction: column;">
                      @for(opt of optionsList;track $index;let i =$index){   <!--i ÁÇ∫ÊØèÂÄãÈ†ÖÁõÆÁöÑÁ¥¢Âºï-->
                        <label style="margin: 5px;">
                          <input #optionInputs type="text"
                                  [(ngModel)]="opt.optionName"
                                  placeholder="Ë´ãËº∏ÂÖ•ÈÅ∏È†ÖÂÖßÂÆπ"
                                  style="width:200px;height:20px;border-radius: 10px;
                                          text-align: center;font-size: 15px;font-family: 'LXGW WenKai TC', monospace;">
                          <span (click)="removeOption(opt.code, i)" style="justify-self:flex-end;margin-left:20px;">‚úï</span>
                        </label>
                      }
                      @if(type=="single" || type=="multiple"){
                        <button (click)="addOption()" class="dialogBtn"
                                style="width:215px;height:30px;border-radius: 20px;margin:5px;
                                      font-size: 20px;background-color: #fff8e4;text-align: center;">+</button>
                      }
                    </div>

                  </div>
                </div>
                <div style="justify-content: center; margin-top: 20px;">
                  <div style="margin-top:10px;width:400px;display: flex;flex-direction: row;justify-content:end;">
                    <!-- <button (click)="cancelEdit()"  class="dialogBtn" style="background-color: #fff8e4;">ÂèñÊ∂à</button> -->
                    <button (click)="save()" class="dialogBtn" style="background-color: #fff8e4;">ÂÑ≤Â≠ò</button>
                  </div>
                </div>

              </div>
            <!-- ---------------------------------------------------------------------------- -->
            }@else {
              <label style="display: flex;flex-direction: row;justify-content: space-between;">
                <div style="font-size: 40px;margin:0px 10px;" (click)="goToTrashcan()">üóë</div>
                <div style="font-size: 40px;margin:0px 10px;" (click)="addQuestion()">+</div>
              </label>
              <table style="width:100%; border-spacing: 0px;overflow: hidden;
                        border-style: none; border-radius: 10px; table-layout: fixed;
                        word-wrap: break-word; overflow-wrap: break-word;">
                <thead style="background-color: #fff8e4; text-align: center;">
                  <tr>
                    <th style="padding: 8px; width:30px;"></th>
                    <th style="padding: 8px;">ÂÖßÂÆπ</th>
                    <th style="padding: 8px;">È°ûÂûã</th>
                    <th style="padding: 8px;">ÂøÖÂ°´/ÈÅ∏Â°´</th>
                    <th style="padding: 8px;">Á∑®ËºØ</th>
                  </tr>
                </thead>
                <tbody style="text-align: center;background-color: #ffeec1">
                  @for(eachQ of questionVoList;track $index){
                    <tr>
                      <td>
                        <input type="checkbox" [checked]="deleteQ.includes(eachQ.questionId)"
                        (change)="questionDelete(eachQ.questionId, eachQ, $event)" style="width:18px;height:18px;"></td>
                      <td style="width:250px; word-wrap: break-word; overflow-wrap: break-word;">{{eachQ.question}}</td>
                      @if(eachQ.type=="single"){
                        <td>ÂñÆÈÅ∏</td>
                      }@else if(eachQ.type=="multiple"){
                        <td>Â§öÈÅ∏</td>
                      }@else{
                        <td>Á∞°Á≠î</td>
                      }

                      <td><input type="checkbox"
                                [(ngModel)]="eachQ.required"
                                (change)="onRequiredChange(eachQ)" class="requiredCheckbox"></td>
                      <td (click)="edit(eachQ.questionId)" style="cursor: pointer;">Á∑®ËºØ</td>
                    </tr>
                  }
                </tbody>
              </table>
            }
          </div>
          @if(questionVoList.length!=0){
            <div style="width:640px;display: flex;justify-content: end;
                        margin-top:50px;">
              <button (click)="goPreview()" class="dialogBtn">È†êË¶Ω</button>
            </div>
          }
          @if(isNewMode()){
            <div #editArea class="edit-section">
              <h3 style="width:500px;margin:10px;">Êñ∞Â¢ûÈ°åÁõÆ</h3>
              <div style="width:500px;display: flex;flex-direction: column;justify-content: center;align-items: first baseline;">
                <div>
                  È°åÁõÆÂÖßÂÆπÔºö
                  <input type="text" [(ngModel)]="question"
                          style="width:350px;border-radius: 5px;height:30px;font-size: 15px;font-family: 'LXGW WenKai TC', monospace;">
                </div>
                <label style="margin: 10px;">
                  <span style="margin-right:24px;margin-left: 24px;">È°ûÂûãÔºö</span>
                  <select [(ngModel)]="type"
                          style="width:200px;height:30px;border:none;border-radius: 10px;
                                  text-align: center;font-size: 15px;font-family: 'LXGW WenKai TC', monospace;">
                    <option value="single">ÂñÆÈÅ∏</option>
                    <option value="multiple">Â§öÈÅ∏</option>
                    <option value="text">Á∞°Á≠î</option>
                  </select>
                </label>
                <div style="display: flex;flex-direction: row;">
                  <p style="margin-right:24px;margin-left: 24px;margin-top:0px;">ÈÅ∏È†ÖÔºö</p>
                  <div style="display: flex;flex-direction: column;">
                    @for(opt of optionsList;track $index;let i =$index){   <!--i ÁÇ∫ÊØèÂÄãÈ†ÖÁõÆÁöÑÁ¥¢Âºï-->
                      <label style="margin: 5px;">
                        <input #optionInputs type="text"
                                [(ngModel)]="opt.optionName"
                                placeholder="Ë´ãËº∏ÂÖ•ÈÅ∏È†ÖÂÖßÂÆπ"
                                style="width:200px;height:20px;border-radius: 10px;
                                        text-align: center;font-size: 15px;font-family: 'LXGW WenKai TC', monospace;">
                        <span (click)="removeOption(opt.code, i)" style="justify-self:flex-end;margin-left:20px;">‚úï</span>
                      </label>
                    }
                    @if(type=="single" || type=="multiple"){
                      <button (click)="addOption()" class="dialogBtn"
                              style="width:215px;height:30px;border-radius: 20px;margin:5px;
                                    font-size: 20px;background-color: #fff8e4;text-align: center;
                                    font-family: 'LXGW WenKai TC', monospace;">+</button>
                    }
                  </div>

                </div>
              </div>
              <div style="justify-content: center; margin-top: 20px;">
                <div style="margin-top:10px;width:400px;display: flex;flex-direction: row;justify-content: space-between;">
                  <button (click)="cancelEdit()"  class="dialogBtn" style="background-color: #fff8e4;">ÂèñÊ∂à</button>
                  <button (click)="save()" class="dialogBtn" style="background-color: #fff8e4;">ÂÑ≤Â≠ò</button>
                </div>
              </div>

            </div>
          }
            <!-- ---------------------------------------------------------------------------- -->
          @if(isEditMode()){
            <div #editArea class="edit-section">
              <h3 style="width:500px;margin:10px;">Á∑®ËºØÈ°åÁõÆ</h3>
              <div style="width:500px;display: flex;flex-direction: column;justify-content: center;align-items: first baseline;">
                <div>
                  È°åÁõÆÂÖßÂÆπÔºö
                  <input type="text" [(ngModel)]="editingQuestion.question"
                          style="width:350px;border-radius: 5px;height:30px;font-size: 15px;font-family: 'LXGW WenKai TC', monospace;">
                </div>
                <label style="margin: 10px;">
                  <span style="margin-right:24px;margin-left: 24px;">È°ûÂûãÔºö</span>
                  <select [(ngModel)]="editingQuestion.type"
                          style="width:200px;height:30px;border:none;border-radius: 10px;
                                  text-align: center;font-size: 15px;font-family: 'LXGW WenKai TC', monospace;">
                    <option value="single">ÂñÆÈÅ∏</option>
                    <option value="multiple">Â§öÈÅ∏</option>
                    <option value="text">Á∞°Á≠î</option>
                  </select>
                </label>
                <div style="display: flex;flex-direction: row;">
                  <p style="margin-right:24px;margin-left: 24px;margin-top:0px;">ÈÅ∏È†ÖÔºö</p>
                  <div style="display: flex;flex-direction: column;">
                    @for(opt of editingQuestion.optionsList;track $index;let i =$index){   <!--i ÁÇ∫ÊØèÂÄãÈ†ÖÁõÆÁöÑÁ¥¢Âºï-->
                      <label style="margin: 5px;">
                        <input #optionInputs type="text"
                                [(ngModel)]="opt.optionName"
                                placeholder="Ë´ãËº∏ÂÖ•ÈÅ∏È†ÖÂÖßÂÆπ"
                                style="width:200px;height:20px;border-radius: 10px;
                                        text-align: center;font-size: 15px;font-family: 'LXGW WenKai TC', monospace;">
                        <span (click)="removeOption(opt.code, i)" style="justify-self:flex-end;margin-left:20px;">‚úï</span>
                      </label>
                    }
                    @if(editingQuestion.type=="single" || editingQuestion.type=="multiple"){
                      <button (click)="addMoreOption()" class="dialogBtn"
                              style="width:215px;height:30px;border-radius: 20px;margin:5px;
                                     font-size: 20px;background-color: #fff8e4;text-align: center;font-family: 'LXGW WenKai TC', monospace;">+</button>
                    }
                  </div>

                </div>
              </div>
              <div style="justify-content: center; margin-top: 20px;">
                <div style="margin-top:10px;width:400px;display: flex;flex-direction: row;justify-content: space-between;">
                  <button (click)="cancelEdit()"  class="dialogBtn" style="background-color: #fff8e4;">ÂèñÊ∂à</button>
                  <button (click)="save()" class="dialogBtn" style="background-color: #fff8e4;">ÂÑ≤Â≠ò</button>
                </div>
              </div>

            </div>
          }
          @if(previewQuestion){
            <div #previewArea class="preview-section">
              <p style="justify-content: end;margin-left:600px;margin-top: 50px;">{{Data.startDate}}~{{Data.endDate}}</p>
              <h1 style="width:800px; text-align: center; word-wrap: break-word; overflow-wrap: break-word;">{{Data.title}}</h1>
              <p style="width:800px; margin:30px 100px;word-wrap: break-word; overflow-wrap: break-word;">{{Data.description}}</p>
                <div style="position: static;inset: 0;background: none;
                            border-radius: 15px;pointer-events: none;z-index: 5;">
                  <!-- <div style="display: flex;flex-direction: column;justify-content: baseline;
                              align-items: baseline;margin-left: 100px;">
                    <label class="info">ÂßìÂêç Ôºö<input></label><br>
                    <label class="info">ÊâãÊ©ü Ôºö<input></label><br>
                    <label class="info">EmailÔºö<input></label><br>
                    <label class="info">Âπ¥ÈΩ° Ôºö<input></label><br>
                  </div> -->
                  <div style="display: flex;flex-direction: column;justify-content: center;
                              align-items: center;">
                    <label class="info">ÂßìÂêç Ôºö<input class="infoInput">
                      <p style="margin-left: 20px;">ÊâãÊ©ü Ôºö<input class="infoInput"></p></label>
                    <label class="info">EmailÔºö<input class="infoInput">
                      <p style="margin-left: 20px;">Âπ¥ÈΩ° Ôºö<input class="infoInput"></p></label>
                  </div>
                  <div>
                    <ol class="question-list" style="width:800px;height:100%; display: flex; flex-direction: column;justify-content: center;
                              align-items: center; margin: 100px 0px;">
                      @for (Q of Data.questionVoList; track $index){
                        <li [class.show]=Q.required style="width:100%;display:flex; align-items: baseline;margin-left: 5%;">
                          <p style="margin:0px 10px;min-width: 0; overflow-wrap: break-word; word-wrap: break-word;">{{Q.question}}</p></li>
                        <div style="width:100%;display: flex; flex-direction: row; justify-content:space-evenly;align-items: center;">
                          @if(Q.type==="single"){
                            @for(i of Q.optionsList;track $index){
                              <label style="height:fit-content; display: flex; flex-direction: row; justify-content: space-between; align-items: center; gap:10px;">
                                <input type="radio" name="{{Q.questionId}}" [value]="i.optionName" class="Q">
                                <span class="option-text">{{ i.optionName }}</span>
                              </label>
                            }
                          }
                          @if(Q.type==="multiple"){
                            @for(i of Q.optionsList;track $index){
                              <label style="height:fit-content; display: flex; flex-direction: row; justify-content: space-between; align-items: center; gap:10px;">
                                <input type="checkbox" class="Q">
                                <span class="option-text">{{ i.optionName }}</span>
                              </label>
                            }
                          }
                          @if(Q.type==="text"){
                            <label style="height:fit-content; display: flex; flex-direction: row; justify-content: space-between; align-items: center; gap:10px;">
                              <textarea class="Q" style="width:650px; height:100px;"></textarea>
                            </label>
                          }
                        </div>
                      }
                    </ol>
                  </div>
                  <!-- <div style="width:800px;display: flex; flex-direction: column;justify-content: center;
                              align-items: center;">
                    <ol>
                      @for(item of Data.questionVoList;track $index){
                        @if(item.required==true){
                          <li>{{item.question}}(ÂøÖÂ°´)</li>
                        }@else{
                          <li>{{item.question}}(ÈÅ∏Â°´)</li>
                        }
                        @if(item.type=="single"){
                          @for(i of item.optionsList;track $index){
                            <input type="radio" name="{{item.questionId}}" [value]="i.optionName"
                            class="Q">{{i.optionName}}
                          }
                        }@else if(item.type=="multiple"){
                          @for(i of item.optionsList;track $index){
                            <input type="checkbox" class="Q">{{i.optionName}}
                          }
                        }@else{
                          <textarea class="Q" style="width:300px;height:100px;"></textarea>
                        }
                      }
                    </ol>
                  </div> -->
                </div>
              <div style="width:700px;display: flex;justify-content: space-between;">
                <button  (click)="again()" class="dialogBtn" style="margin-left:40px;background-color: #fff8e4;">ÂÜç‰øÆÊîπ</button>
                <div>
                  <button  (click)="store()" class="dialogBtn" style="margin-left:40px;background-color: #fff8e4;">ÂÑ≤Â≠òÔºå‰∏çÁôºÂ∏É</button>
                  <button  (click)="push()" class="dialogBtn" style="margin-left:40px;background-color: #fff8e4;">ÂÑ≤Â≠ò‰∏¶ÁôºÂ∏É</button>
                </div>
              </div>
            </div>
          }
        }
      </dialog>

      <table style="width:100%; border-spacing: 0px;overflow: hidden;
                    border-style: none; border-radius: 10px;table-layout: fixed;
                    word-wrap: break-word; overflow-wrap: break-word;">
        <thead style="background-color: #fff8e4; text-align: center;">
          <tr>
            <th style="padding: 8px; width:30px;"></th>
            <th style="padding: 8px; width:80px;">Á∑®Ëôü</th>
            <th style="padding: 8px;">ÂêçÁ®±</th>
            <th style="padding: 8px;">ÁãÄÊÖã</th>
            <th style="padding: 8px;">ÈñãÂßãÊôÇÈñì</th>
            <th style="padding: 8px;">ÁµêÊùüÊôÇÈñì</th>
            <!-- <th style="padding: 8px;">Á∑®ËºØ</th> -->
            <th style="padding: 8px;">ÁµêÊûú</th>
          </tr>
        </thead>
        <tbody style="text-align: center;background-color: #ffeec1">

          @if(this.dataSource.length==0){
            <tr>
              <td colspan="7" style="text-align: center;">Êü•ÁÑ°Ë≥áÊñô</td>  <!-- colspan:Ë∑®Ë∂ä -->
            </tr>
          }@else {
            @for(eachRow of dataSource;track $index){
            <!-- cursorÔºöÊªëÈº†Ê∏∏Ê®ôÊ®£Âºè pointerÔºöÊâãÊåáÂúñÁ§∫ -->
              @if(eachRow.status==2){
                <tr>
                  <td></td>
                  <td style="padding: 8px;">{{eachRow.id}}</td>
                  <!-- Angular ‰∏çÂÖÅË®±Âú®Âêå‰∏ÄÂÄãÂÖÉÁ¥†‰∏ä ÂêåÊôÇ‰ΩøÁî® [innerHTML] ÂíåÊèíÂÄº {{ }}ÔºåÂèØ‰ª•ÂØ´{{ }}‰ΩÜÊ≤íÁî®ÔºåÂ§öÈ§òÂØ´ÁöÑ
                      ÂÖàÁî¢Áîü <button>{{eachRow.title}}</button> => ÂÜçÂü∑Ë°å [innerHTML]ÔºåÊääÊï¥ÂÄãÂÖßÂÆπÊîπÊàê‰Ω†ÂõûÂÇ≥ÁöÑÂ≠ó‰∏≤ÔºàHTML ÂÖßÂÆπÔºâ -->
                  <td [innerHTML]="highlight(eachRow.title)"
                      style="width:250px;">{{eachRow.title}}</td>
                  <td>ÈÄ≤Ë°å‰∏≠</td>
                  <td>{{eachRow.startDate}}</td>
                  <td>{{eachRow.endDate}}</td>
                  <!-- ÊéßÂà∂pointerÂ§±Êïà -->
                  <!-- <td></td> -->
                  <td (click)="goTo(eachRow.id)" class="count" style="cursor: pointer;">Êü•Áúã</td>
                </tr>
              }@else if(eachRow.status==1){
                <tr style="cursor: pointer;" class="btn" (click)="revise(eachRow.id)">
                  <td style="text-align: center;">
                    <input type="checkbox" [checked]="deleteQuestionnaire.includes(eachRow.id)"
                    (change)="questionnaireDelete(eachRow.id, eachRow, $event)"
                    (click)="$event.stopPropagation()" style="width:18px;height:18px;"></td>  <!-- ‚úÖ ÈòªÊ≠¢ÂÜíÊ≥° -->
                  <td style="padding: 8px;">{{eachRow.id}}</td>
                  <!-- Angular ‰∏çÂÖÅË®±Âú®Âêå‰∏ÄÂÄãÂÖÉÁ¥†‰∏ä ÂêåÊôÇ‰ΩøÁî® [innerHTML] ÂíåÊèíÂÄº {{ }}ÔºåÂèØ‰ª•ÂØ´{{ }}‰ΩÜÊ≤íÁî®ÔºåÂ§öÈ§òÂØ´ÁöÑ
                      ÂÖàÁî¢Áîü <button>{{eachRow.title}}</button> => ÂÜçÂü∑Ë°å [innerHTML]ÔºåÊääÊï¥ÂÄãÂÖßÂÆπÊîπÊàê‰Ω†ÂõûÂÇ≥ÁöÑÂ≠ó‰∏≤ÔºàHTML ÂÖßÂÆπÔºâ -->
                  <td [innerHTML]="highlight(eachRow.title)"
                      style="width:250px;">{{eachRow.title}}</td>
                  <td>Êú™ÈñãÂßã</td>
                  <td>{{eachRow.startDate}}</td>
                  <td>{{eachRow.endDate}}</td>
                  <!-- ÊéßÂà∂pointerÂ§±Êïà -->
                  <!-- <td style="pointer-events: none;"></td> -->
                  <td>Êú™ÈñãÂßã</td>
                </tr>
              }@else if(eachRow.status==4){
                <tr style="cursor: pointer;" class="btn" (click)="revise(eachRow.id)">
                  <td style="text-align: center;">
                    <input type="checkbox" [checked]="deleteQuestionnaire.includes(eachRow.id)"
                    (change)="questionnaireDelete(eachRow.id, eachRow, $event)"
                    (click)="$event.stopPropagation()" style="width:18px;height:18px;"></td>  <!-- ‚úÖ ÈòªÊ≠¢ÂÜíÊ≥° -->
                  <td style="padding: 8px;">{{eachRow.id}}</td>
                  <!-- Angular ‰∏çÂÖÅË®±Âú®Âêå‰∏ÄÂÄãÂÖÉÁ¥†‰∏ä ÂêåÊôÇ‰ΩøÁî® [innerHTML] ÂíåÊèíÂÄº {{ }}ÔºåÂèØ‰ª•ÂØ´{{ }}‰ΩÜÊ≤íÁî®ÔºåÂ§öÈ§òÂØ´ÁöÑ
                      ÂÖàÁî¢Áîü <button>{{eachRow.title}}</button> => ÂÜçÂü∑Ë°å [innerHTML]ÔºåÊääÊï¥ÂÄãÂÖßÂÆπÊîπÊàê‰Ω†ÂõûÂÇ≥ÁöÑÂ≠ó‰∏≤ÔºàHTML ÂÖßÂÆπÔºâ -->
                  <td [innerHTML]="highlight(eachRow.title)"
                      style="width:250px;">{{eachRow.title}}</td>
                  <td>Êú™ÁôºÂ∏É</td>
                  <td>{{eachRow.startDate}}</td>
                  <td>{{eachRow.endDate}}</td>
                  <!-- ÊéßÂà∂pointerÂ§±Êïà -->
                  <!-- <td style="pointer-events: none;"></td> -->
                  <td>---</td>
                </tr>
              }@else {
                <tr>
                  <td style="text-align: center;">
                    <input  type="checkbox" [checked]="deleteQuestionnaire.includes(eachRow.id)"
                    (change)="questionnaireDelete(eachRow.id, eachRow, $event)"
                    (click)="$event.stopPropagation()" style="width:18px;height:18px;"></td>  <!-- ‚úÖ ÈòªÊ≠¢ÂÜíÊ≥° -->
                  <td style="padding: 8px;">{{eachRow.id}}</td>
                  <!-- Angular ‰∏çÂÖÅË®±Âú®Âêå‰∏ÄÂÄãÂÖÉÁ¥†‰∏ä ÂêåÊôÇ‰ΩøÁî® [innerHTML] ÂíåÊèíÂÄº {{ }}ÔºåÂèØ‰ª•ÂØ´{{ }}‰ΩÜÊ≤íÁî®ÔºåÂ§öÈ§òÂØ´ÁöÑ
                      ÂÖàÁî¢Áîü <button>{{eachRow.title}}</button> => ÂÜçÂü∑Ë°å [innerHTML]ÔºåÊääÊï¥ÂÄãÂÖßÂÆπÊîπÊàê‰Ω†ÂõûÂÇ≥ÁöÑÂ≠ó‰∏≤ÔºàHTML ÂÖßÂÆπÔºâ -->
                  <td [innerHTML]="highlight(eachRow.title)"
                      style="width:250px;">{{eachRow.title}}</td>
                  <td>Â∑≤ÁµêÊùü</td>
                  <td>{{eachRow.startDate}}</td>
                  <td>{{eachRow.endDate}}</td>
                  <!-- ÊéßÂà∂pointerÂ§±Êïà -->
                  <!-- <td style="pointer-events: none;"></td> -->
                  <td (click)="goTo(eachRow.id)" class="count" style="cursor: pointer;">Êü•Áúã</td>
                </tr>
              }
            }
          }
        </tbody>
      </table>

      <dialog #reviseDialog>
        <div (click)="closeDialog()" style="justify-self:flex-end;margin-right:20px;cursor: pointer;">‚úï</div>
        <div class="tabs">
          <button class="tab-btn" [class.active]="activeTab==='tab1'" (click)="activeTab='tab1'">ÂïèÂç∑</button>
          <button class="tab-btn" [class.active]="activeTab==='tab2'" (click)="activeTab='tab2'">È°åÁõÆ</button>
        </div>

        @if (activeTab === 'tab1') {
          <div style="flex: 1;overflow-y: auto;display: flex;flex-direction: column;justify-content: center;align-items: center;">
            <label style="margin:20px 0px;">ÂïèÂç∑ÂêçÁ®±Ôºö
              <input class="edit-input" style="width:500px;border-radius: 5px;" [(ngModel)]="title"></label>
            <label style="margin:20px 0px;" style="display: flex; align-items: flex-start;">ÂïèÂç∑Ë™™ÊòéÔºö
              <textarea class="edit-input" style="width:500px;border-radius: 5px;" [(ngModel)]="description"></textarea></label>
            <label style="margin:13px;">
              ÂïèÂç∑ÊôÇÈñìÔºö<input type="date"
                    style="width:225px;height:25px;border-radius:5px;margin:0 10px;
                            text-align:center;font-size:18px;background-color:#ffffff;
                            border:none;color:#ffca61;"
                    [(ngModel)]="startDate">
                ~<input type="date"
                    style="width:225px;height:25px;border-radius:5px;margin:0 10px;
                            text-align:center;font-size:18px;background-color:#ffffff;
                            border:none;color:#ffca61;"
                    [(ngModel)]="endDate">
            </label>
            <div style="width:500px;display: flex;justify-content: space-between;
                        margin-top:100px;">
              <button class="dialogBtn"  (click)="reviseCancel()">ÂèñÊ∂à</button>
              <button class="dialogBtn" (click)="saveQuestion()">Á¢∫ÂÆö</button>
            </div>
          </div>

        } @else if (activeTab === 'tab2') {
          <div style="margin-top: 10px;">
            <!-- ---------------------------------------------------------------------------- -->
            <!-- @if(questionVoList.length==0){
              <div #editArea class="edit-section">
                <h3 style="width:500px;margin:10px;">Êñ∞Â¢ûÈ°åÁõÆ</h3>
                <div style="width:500px;display: flex;flex-direction: column;justify-content: center;align-items: first baseline;">
                  <div>
                    È°åÁõÆÂÖßÂÆπÔºö
                    <input type="text" [(ngModel)]="question"
                            style="width:350px;border-radius: 5px;height:30px;font-size: 15px;">
                  </div>
                  <label style="margin: 10px;">
                    <span style="margin-right:24px;margin-left: 24px;">È°ûÂûãÔºö</span>
                    <select [(ngModel)]="type"
                            style="width:200px;height:30px;border:none;border-radius: 10px;
                                    text-align: center;font-size: 15px;">
                      <option value="single">ÂñÆÈÅ∏</option>
                      <option value="multiple">Â§öÈÅ∏</option>
                      <option value="text">Á∞°Á≠î</option>
                    </select>
                  </label>
                  <div style="display: flex;flex-direction: row;">
                    <p style="margin-right:24px;margin-left: 24px;margin-top:0px;">ÈÅ∏È†ÖÔºö</p>
                    <div style="display: flex;flex-direction: column;">
                      @for(opt of optionsList;track $index;let i =$index){                  i ÁÇ∫ÊØèÂÄãÈ†ÖÁõÆÁöÑÁ¥¢Âºï
                        <label style="margin: 5px;">
                          <input #optionInputs type="text"
                                  [(ngModel)]="opt.optionName"
                                  placeholder="Ë´ãËº∏ÂÖ•ÈÅ∏È†ÖÂÖßÂÆπ"
                                  style="width:200px;height:20px;border-radius: 10px;
                                          text-align: center;font-size: 15px;">
                          <span (click)="removeOption(opt.code, i)" style="justify-self:flex-end;margin-left:20px;">‚úï</span>
                        </label>
                      }
                      @if(type=="single" || type=="multiple"){
                        <button (click)="addOption()" class="dialogBtn"
                                style="width:215px;height:30px;border-radius: 20px;margin:5px;
                                      font-size: 20px;background-color: #fff8e4;text-align: center;">+</button>
                      }
                    </div>

                  </div>
                </div>
                <div style="justify-content: center; margin-top: 20px;">
                  <div style="margin-top:10px;width:400px;display: flex;flex-direction: row;justify-content: space-between;">
                    button (click)="cancelEdit()"  class="dialogBtn" style="background-color: #fff8e4;">ÂèñÊ∂à</button
                    <button (click)="save()" class="dialogBtn" style="background-color: #fff8e4;">ÂÑ≤Â≠ò</button>
                  </div>
                </div>

              </div>
            ----------------------------------------------------------------------------
            } @else {-->
              <label style="display: flex;flex-direction: row;justify-content: space-between;">
                <div style="font-size: 40px;margin:0px 10px;" (click)="goToTrashcan()">üóë</div>
                <div style="font-size: 40px;margin:0px 10px;" (click)="addQuestion()">+</div>
              </label>
              <table style="width:100%; border-spacing: 0px;overflow: hidden;
                        border-style: none; border-radius: 10px; table-layout: fixed;
                        word-wrap: break-word; overflow-wrap: break-word;">
                <thead style="background-color: #fff8e4; text-align: center;">
                  <tr>
                    <th style="padding: 8px; width:30px;"></th>
                    <th style="padding: 8px;">ÂÖßÂÆπ</th>
                    <th style="padding: 8px;">È°ûÂûã</th>
                    <th style="padding: 8px;">ÂøÖÂ°´/ÈÅ∏Â°´</th>
                    <th style="padding: 8px;">Á∑®ËºØ</th>
                  </tr>
                </thead>
                <tbody style="text-align: center;background-color: #ffeec1">
                  @for(eachQ of questionVoList;track $index){
                    <tr>
                      <td>
                        <input type="checkbox" [checked]="deleteQ.includes(eachQ.questionId)"
                        (change)="questionDelete(eachQ.questionId, eachQ, $event)" style="width:18px;height:18px;"></td>
                      <td style="width:250px;word-wrap: break-word; overflow-wrap: break-word;">{{eachQ.question}}</td>
                      @if(eachQ.type=="single"){
                        <td>ÂñÆÈÅ∏</td>
                      }@else if(eachQ.type=="multiple"){
                        <td>Â§öÈÅ∏</td>
                      }@else{
                        <td>Á∞°Á≠î</td>
                      }

                      <td><input type="checkbox"
                                [(ngModel)]="eachQ.required"
                                (change)="onRequiredChange(eachQ)" class="requiredCheckbox"></td>
                      <td (click)="edit(eachQ.questionId)" style="cursor: pointer;">Á∑®ËºØ</td>
                    </tr>
                  }
                </tbody>
              </table>
            <!-- } -->
          </div>
          @if(questionVoList.length!=0){
            <div style="width:640px;display: flex;justify-content: end;
                        margin-top:50px;">
              <button (click)="goPreview()" class="dialogBtn">È†êË¶Ω</button>
            </div>
          }
          @if(isNewMode()){
            <div #editArea class="edit-section">
              <h3 style="width:500px;margin:10px;">Êñ∞Â¢ûÈ°åÁõÆ</h3>
              <div style="width:500px;display: flex;flex-direction: column;justify-content: center;align-items: first baseline;">
                <div>
                  È°åÁõÆÂÖßÂÆπÔºö
                  <input type="text" [(ngModel)]="question"
                          style="width:350px;border-radius: 5px;height:30px;font-size: 15px;">
                </div>
                <label style="margin: 10px;">
                  <span style="margin-right:24px;margin-left: 24px;">È°ûÂûãÔºö</span>
                  <select [(ngModel)]="type"
                          style="width:200px;height:30px;border:none;border-radius: 10px;
                                  text-align: center;font-size: 15px;">
                    <option value="single">ÂñÆÈÅ∏</option>
                    <option value="multiple">Â§öÈÅ∏</option>
                    <option value="text">Á∞°Á≠î</option>
                  </select>
                </label>
                <div style="display: flex;flex-direction: row;">
                  <p style="margin-right:24px;margin-left: 24px;margin-top:0px;">ÈÅ∏È†ÖÔºö</p>
                  <div style="display: flex;flex-direction: column;">
                    @for(opt of optionsList;track $index;let i =$index){   <!--i ÁÇ∫ÊØèÂÄãÈ†ÖÁõÆÁöÑÁ¥¢Âºï-->
                      <label style="margin: 5px;">
                        <input #optionInputs type="text"
                                [(ngModel)]="opt.optionName"
                                placeholder="Ë´ãËº∏ÂÖ•ÈÅ∏È†ÖÂÖßÂÆπ"
                                style="width:200px;height:20px;border-radius: 10px;
                                        text-align: center;font-size: 15px;">
                        <span (click)="removeOption(opt.code, i)" style="justify-self:flex-end;margin-left:20px;">‚úï</span>
                      </label>
                    }
                    @if(type=="single" || type=="multiple"){
                      <button (click)="addOption()" class="dialogBtn"
                              style="width:215px;height:30px;border-radius: 20px;margin:5px;
                                    font-size: 20px;background-color: #fff8e4;text-align: center;">+</button>
                    }
                  </div>

                </div>
              </div>
              <div style="justify-content: center; margin-top: 20px;">
                <div style="margin-top:10px;width:400px;display: flex;flex-direction: row;justify-content: space-between;">
                  <button (click)="cancelEdit()"  class="dialogBtn" style="background-color: #fff8e4;">ÂèñÊ∂à</button>
                  <button (click)="save()" class="dialogBtn" style="background-color: #fff8e4;">ÂÑ≤Â≠ò</button>
                </div>
              </div>

            </div>
          }
            <!-- ---------------------------------------------------------------------------- -->
          @if(isEditMode()){
            <div #editArea class="edit-section">
              <h3 style="width:500px;margin:10px;">Á∑®ËºØÈ°åÁõÆ</h3>
              <div style="width:500px;display: flex;flex-direction: column;justify-content: center;align-items: first baseline;">
                <div>
                  È°åÁõÆÂÖßÂÆπÔºö
                  <input type="text" [(ngModel)]="editingQuestion.question"
                          style="width:350px;border-radius: 5px;height:30px;font-size: 15px;">
                </div>
                <label style="margin: 10px;">
                  <span style="margin-right:24px;margin-left: 24px;">È°ûÂûãÔºö</span>
                  <select [(ngModel)]="editingQuestion.type"
                          style="width:200px;height:30px;border:none;border-radius: 10px;
                                  text-align: center;font-size: 15px;">
                    <option value="single">ÂñÆÈÅ∏</option>
                    <option value="multiple">Â§öÈÅ∏</option>
                    <option value="text">Á∞°Á≠î</option>
                  </select>
                </label>
                <div style="display: flex;flex-direction: row;">
                  <p style="margin-right:24px;margin-left: 24px;margin-top:0px;">ÈÅ∏È†ÖÔºö</p>
                  <div style="display: flex;flex-direction: column;">
                    @for(opt of editingQuestion.optionsList;track $index;let i =$index){   <!--i ÁÇ∫ÊØèÂÄãÈ†ÖÁõÆÁöÑÁ¥¢Âºï-->
                      <label style="margin: 5px;">
                        <input #optionInputs type="text"
                                [(ngModel)]="opt.optionName"
                                placeholder="Ë´ãËº∏ÂÖ•ÈÅ∏È†ÖÂÖßÂÆπ"
                                style="width:200px;height:20px;border-radius: 10px;
                                        text-align: center;font-size: 15px;">
                        <span (click)="removeOption(opt.code, i)" style="justify-self:flex-end;margin-left:20px;">‚úï</span>
                      </label>
                    }
                    @if(editingQuestion.type=="single" || editingQuestion.type=="multiple"){
                      <button (click)="addMoreOption()" class="dialogBtn"
                              style="width:215px;height:30px;border-radius: 20px;margin:5px;
                                     font-size: 20px;background-color: #fff8e4;text-align: center;">+</button>
                    }
                  </div>

                </div>
              </div>
              <div style="justify-content: center; margin-top: 20px;">
                <div style="margin-top:10px;width:400px;display: flex;flex-direction: row;justify-content: space-between;">
                  <button (click)="cancelEdit()"  class="dialogBtn" style="background-color: #fff8e4;">ÂèñÊ∂à</button>
                  <button (click)="save()" class="dialogBtn" style="background-color: #fff8e4;">ÂÑ≤Â≠ò</button>
                </div>
              </div>

            </div>
          }
          @if(previewQuestion){
            <div #previewArea class="preview-section">
              <p style="justify-content: end;margin-left:600px;margin-top: 50px;">{{Data.startDate}}~{{Data.endDate}}</p>
              <h1 style="width:800px; text-align: center; word-wrap: break-word; overflow-wrap: break-word;">{{Data.title}}</h1>
              <p style="width:800px; margin:30px 100px; text-align: center;word-wrap: break-word; overflow-wrap: break-word;">{{Data.description}}</p>
                <div style="position: static;inset: 0;background: none;
                            border-radius: 15px;pointer-events: none;z-index: 5;">
                  <div style="display: flex;flex-direction: column;justify-content: center;
                              align-items: center;">
                    <label class="info">ÂßìÂêç Ôºö<input class="infoInput">
                      <p style="margin-left: 20px;">ÊâãÊ©ü Ôºö<input class="infoInput"></p></label>
                    <label class="info">EmailÔºö<input class="infoInput">
                      <p style="margin-left: 20px;">Âπ¥ÈΩ° Ôºö<input class="infoInput"></p></label>
                  </div>
                  <div>
                    <ol class="question-list" style="width:800px;height:100%; display: flex; flex-direction: column;justify-content: center;
                              align-items: center; margin: 100px 0px;">
                      @for (Q of Data.questionVoList; track $index){
                        <li [class.show]=Q.required style="width:100%;display:flex; align-items: baseline;margin-left: 5%;">
                          <p style="margin:0px 10px;min-width: 0; overflow-wrap: break-word; word-wrap: break-word;">{{Q.question}}</p></li>
                        <div style="width:100%;display: flex; flex-direction: row; justify-content:space-evenly;align-items: center;">
                          @if(Q.type==="single"){
                            @for(i of Q.optionsList;track $index){
                              <label style="height:fit-content; display: flex; flex-direction: row; justify-content: space-between; align-items: center; gap:10px;">
                                <input type="radio" name="{{Q.questionId}}" [value]="i.optionName"
                                        class="Q">{{i.optionName}}
                              </label>
                            }
                          }
                          @if(Q.type==="multiple"){
                            @for(i of Q.optionsList;track $index){
                              <label style="height:fit-content; display: flex; flex-direction: row; justify-content: space-between; align-items: center; gap:10px;">
                                <input type="checkbox" class="Q">{{i.optionName}}
                              </label>
                            }
                          }
                          @if(Q.type==="text"){
                            <label style="height:fit-content; display: flex; flex-direction: row; justify-content: space-between; align-items: center; gap:10px;">
                              <textarea class="Q" style="width:650px; height:100px;"></textarea>
                            </label>
                          }
                        </div>
                      }
                    </ol>
                  </div>
                </div>
              <div style="width:700px;display: flex;justify-content: space-between;">
                <button  (click)="again()" class="dialogBtn" style="margin-left:40px;background-color: #fff8e4;">ÂÜç‰øÆÊîπ</button>
                <div>
                  <button  (click)="store()" class="dialogBtn" style="margin-left:40px;background-color: #fff8e4;">ÂÑ≤Â≠òÔºå‰∏çÁôºÂ∏É</button>
                  <button  (click)="push()" class="dialogBtn" style="margin-left:40px;background-color: #fff8e4;">ÂÑ≤Â≠ò‰∏¶ÁôºÂ∏É</button>
                </div>
              </div>
            </div>
          }
        }
      </dialog>

      @if(this.dataLength>5){
        <div class="paginator">
          <button class="page-btn" (click)="prevPage()" [disabled]="currentPage === 1">‚Üê ‰∏ä‰∏ÄÈ†Å</button>
          <span style="color: #fff8e4;">{{ currentPage }} / {{ totalPages }}</span>
          <button class="page-btn" (click)="nextPage()" [disabled]="currentPage === totalPages">‰∏ã‰∏ÄÈ†Å ‚Üí</button>
        </div>
      }

    </div>
  </div>

</div>
